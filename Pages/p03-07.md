# Cointegration

## 🌟 **1. What is Cointegration? (Layman Explanation)**

✅ **Imagine two drunk friends walking together.**

* Individually, each **stumbles randomly** (non-stationary).
* But because they **hold hands**, they **stay close together** even as they move around.

🔑 **In time series:**

✔️ Two series are **individually non-stationary (random walk)**
✔️ But **together they maintain a stable relationship** → **cointegrated**.

---

### 🧠 **Example (Finance):**

* Stock A and Stock B prices both wander over time (non-stationary).
* But if they belong to the **same sector**, their **price difference remains stable** → they are **cointegrated**.

---

### ✅ **Why is Cointegration Important?**

✔️ Helps in **pairs trading strategies**.
✔️ Indicates **long-term equilibrium relationship**.
✔️ Needed in **Vector Error Correction Models (VECM)** for multivariate time series modeling.

---

## 🔬 **2. Technical Definition**

* Two series are **cointegrated** if a **linear combination of them is stationary**.

### **Cointegration Test:**

1. **Engle-Granger Test**

   * Null Hypothesis (H0): No cointegration.
   * If **p-value < 0.05**, reject H0 → **Cointegration exists**.

2. **Johansen Test**

   * For testing **multiple series cointegration**.

---

## 🐍 **3. How to Perform Cointegration Test in Python**

Here is a **step-by-step practical example**:

---

### 🔷 **Step 1. Install and import libraries**

```python
# Install via: pip install statsmodels

import pandas as pd
import numpy as np
from statsmodels.tsa.stattools import coint
import matplotlib.pyplot as plt
```

---

### 🔷 **Step 2. Create sample data**

#### ✅ **Simulate two cointegrated series**

```python
np.random.seed(42)

# Generate random walk x
x = np.cumsum(np.random.normal(0, 1, 100))

# Create y as x plus some noise
y = x + np.random.normal(0, 1, 100)

# Plot
plt.plot(x, label='x')
plt.plot(y, label='y')
plt.legend()
plt.title("Two Cointegrated Series")
plt.show()
```

---

### 🔷 **Step 3. Perform Engle-Granger Cointegration Test**

```python
# Perform cointegration test
score, pvalue, _ = coint(x, y)

print("Cointegration Test p-value:", pvalue)

# Interpretation
if pvalue < 0.05:
    print("Conclusion: x and y are cointegrated (long-run equilibrium relationship exists).")
else:
    print("Conclusion: x and y are NOT cointegrated.")
```

---

### 🔷 **Step 4. Johansen Test for multiple series**

For **multiple time series cointegration**, use **Johansen Test**:

```python
# Install via: pip install statsmodels

from statsmodels.tsa.vector_ar.vecm import coint_johansen

# Combine into DataFrame
df = pd.DataFrame({'x': x, 'y': y})

# Perform Johansen test
result = coint_johansen(df, det_order=0, k_ar_diff=1)

# Trace statistic and critical values
print("Trace Statistic:\n", result.lr1)
print("Critical Values (90%, 95%, 99%):\n", result.cvt)

# Interpretation
for i in range(len(result.lr1)):
    if result.lr1[i] > result.cvt[i, 1]:  # comparing with 95% critical value
        print(f"Rank {i}: Cointegration exists.")
    else:
        print(f"Rank {i}: No cointegration.")
```

---

## 💡 **4. Final Summary (Layman)**

✔️ **Cointegration = Two non-stationary series move together in a stable way.**
✔️ **Why important?** Indicates **long-term relationship**, useful in **economics and finance**.
✔️ **How to check?** Use **Engle-Granger** for two series and **Johansen Test** for multiple series in Python.

---
